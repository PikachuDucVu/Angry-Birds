{"ast":null,"code":"import _initializerDefineProperty from \"D:/projects/test-game/node_modules/@babel/runtime/helpers/esm/initializerDefineProperty.js\";\nimport _applyDecoratedDescriptor from \"D:/projects/test-game/node_modules/@babel/runtime/helpers/esm/applyDecoratedDescriptor.js\";\nimport _initializerWarningHelper from \"D:/projects/test-game/node_modules/@babel/runtime/helpers/esm/initializerWarningHelper.js\";\n\nvar _dec, _dec2, _dec3, _dec4, _dec5, _dec6, _dec7, _dec8, _class, _descriptor, _descriptor2, _descriptor3, _descriptor4, _descriptor5, _descriptor6, _descriptor7, _descriptor8;\n\nimport { b2BodyType } from \"box2d.ts\";\nimport { System, Inject } from \"flat-ecs\";\nimport { InputEvent } from \"gdxts\";\nimport { Constants } from \"../Constants\";\nexport let inputHandlerSystem = (_dec = Inject(\"inputHandler\"), _dec2 = Inject(\"originPosition\"), _dec3 = Inject(\"slingPos\"), _dec4 = Inject(\"bird\"), _dec5 = Inject(\"boxes\"), _dec6 = Inject(\"birdOnSlingShot\"), _dec7 = Inject(\"physicWorld\"), _dec8 = Inject(\"levelState\"), (_class = class inputHandlerSystem extends System {\n  constructor() {\n    super(...arguments);\n\n    _initializerDefineProperty(this, \"inputHandler\", _descriptor, this);\n\n    _initializerDefineProperty(this, \"originPosition\", _descriptor2, this);\n\n    _initializerDefineProperty(this, \"slingPos\", _descriptor3, this);\n\n    _initializerDefineProperty(this, \"bird\", _descriptor4, this);\n\n    _initializerDefineProperty(this, \"boxes\", _descriptor5, this);\n\n    _initializerDefineProperty(this, \"birdOnSlingShot\", _descriptor6, this);\n\n    _initializerDefineProperty(this, \"physicWorld\", _descriptor7, this);\n\n    _initializerDefineProperty(this, \"levelState\", _descriptor8, this);\n  }\n\n  initialized() {\n    this.inputHandler.addEventListener(InputEvent.TouchMove, () => {\n      if (this.inputHandler.isTouched()) {\n        this.slingPos.setVector(this.inputHandler.getTouchedWorldCoord());\n      }\n    });\n    this.inputHandler.addEventListener(InputEvent.TouchEnd, () => {\n      if (this.levelState.conditionWin === false) {\n        if (this.levelState.birdCount < 3) {\n          this.bird[this.levelState.birdCount].SetType(b2BodyType.b2_dynamicBody);\n          this.bird[this.levelState.birdCount].ApplyLinearImpulseToCenter({\n            x: 7 * (this.originPosition.x - this.slingPos.x) / Constants.METER_TO_WORLD,\n            y: 7 * (this.originPosition.y - this.slingPos.y) / Constants.METER_TO_WORLD\n          }, true);\n        }\n\n        this.levelState.birdCount++;\n\n        if (this.levelState.birdCount + 1 <= 3 && this.bird.length !== 0) {\n          setTimeout(() => {\n            this.bird[this.levelState.birdCount].SetPositionXY(2, 3.45);\n          }, 1000);\n        }\n      } else {\n        if (this.levelState.conditionWin) {\n          for (let i = 0; i < this.bird.length; i++) {\n            this.physicWorld.DestroyBody(this.bird[i]);\n            this.bird.splice(i, 1);\n            console.warn(this.bird.length);\n          }\n\n          for (let i = 0; i < this.boxes.length; i++) {\n            this.physicWorld.DestroyBody(this.boxes[i]);\n            this.boxes.splice(i, 1);\n            console.warn(this.boxes.length);\n          }\n        }\n      }\n    }); // window.onkeydown = (ev: KeyboardEvent): any => {\n    //   if (!this.this.birdOnSlingShot && ev.key === \"r\") {\n    //   }\n    // };\n  }\n\n  process() {}\n\n}, (_descriptor = _applyDecoratedDescriptor(_class.prototype, \"inputHandler\", [_dec], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: null\n}), _descriptor2 = _applyDecoratedDescriptor(_class.prototype, \"originPosition\", [_dec2], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: null\n}), _descriptor3 = _applyDecoratedDescriptor(_class.prototype, \"slingPos\", [_dec3], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: null\n}), _descriptor4 = _applyDecoratedDescriptor(_class.prototype, \"bird\", [_dec4], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: null\n}), _descriptor5 = _applyDecoratedDescriptor(_class.prototype, \"boxes\", [_dec5], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: null\n}), _descriptor6 = _applyDecoratedDescriptor(_class.prototype, \"birdOnSlingShot\", [_dec6], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: null\n}), _descriptor7 = _applyDecoratedDescriptor(_class.prototype, \"physicWorld\", [_dec7], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: null\n}), _descriptor8 = _applyDecoratedDescriptor(_class.prototype, \"levelState\", [_dec8], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: null\n})), _class));","map":{"version":3,"names":["b2BodyType","System","Inject","InputEvent","Constants","inputHandlerSystem","initialized","inputHandler","addEventListener","TouchMove","isTouched","slingPos","setVector","getTouchedWorldCoord","TouchEnd","levelState","conditionWin","birdCount","bird","SetType","b2_dynamicBody","ApplyLinearImpulseToCenter","x","originPosition","METER_TO_WORLD","y","length","setTimeout","SetPositionXY","i","physicWorld","DestroyBody","splice","console","warn","boxes","process"],"sources":["D:/projects/test-game/src/system/inputHandleSystem.ts"],"sourcesContent":["import { b2Body, b2BodyType, b2World } from \"box2d.ts\";\r\nimport { System, Inject } from \"flat-ecs\";\r\nimport { InputEvent, Vector2, ViewportInputHandler } from \"gdxts\";\r\nimport { Constants } from \"../Constants\";\r\nimport { LevelState } from \"../data/LevelState\";\r\n\r\nexport class inputHandlerSystem extends System {\r\n  @Inject(\"inputHandler\") inputHandler: ViewportInputHandler;\r\n  @Inject(\"originPosition\") originPosition: Vector2;\r\n  @Inject(\"slingPos\") slingPos: Vector2;\r\n  @Inject(\"bird\") bird: b2Body[];\r\n  @Inject(\"boxes\") boxes: b2Body[];\r\n  @Inject(\"birdOnSlingShot\") birdOnSlingShot: boolean;\r\n  @Inject(\"physicWorld\") physicWorld: b2World;\r\n  @Inject(\"levelState\") levelState: LevelState;\r\n  initialized(): void {\r\n    this.inputHandler.addEventListener(InputEvent.TouchMove, () => {\r\n      if (this.inputHandler.isTouched()) {\r\n        this.slingPos.setVector(this.inputHandler.getTouchedWorldCoord());\r\n      }\r\n    });\r\n    this.inputHandler.addEventListener(InputEvent.TouchEnd, () => {\r\n      if (this.levelState.conditionWin === false) {\r\n        if (this.levelState.birdCount < 3) {\r\n          this.bird[this.levelState.birdCount].SetType(\r\n            b2BodyType.b2_dynamicBody\r\n          );\r\n          this.bird[this.levelState.birdCount].ApplyLinearImpulseToCenter(\r\n            {\r\n              x:\r\n                (7 * (this.originPosition.x - this.slingPos.x)) /\r\n                Constants.METER_TO_WORLD,\r\n              y:\r\n                (7 * (this.originPosition.y - this.slingPos.y)) /\r\n                Constants.METER_TO_WORLD,\r\n            },\r\n            true\r\n          );\r\n        }\r\n        this.levelState.birdCount++;\r\n        if (this.levelState.birdCount + 1 <= 3 && this.bird.length !== 0) {\r\n          setTimeout(() => {\r\n            this.bird[this.levelState.birdCount].SetPositionXY(2, 3.45);\r\n          }, 1000);\r\n        }\r\n      } else {\r\n        if (this.levelState.conditionWin) {\r\n          for (let i = 0; i < this.bird.length; i++) {\r\n            this.physicWorld.DestroyBody(this.bird[i]);\r\n            this.bird.splice(i, 1);\r\n            console.warn(this.bird.length);\r\n          }\r\n          for (let i = 0; i < this.boxes.length; i++) {\r\n            this.physicWorld.DestroyBody(this.boxes[i]);\r\n            this.boxes.splice(i, 1);\r\n            console.warn(this.boxes.length);\r\n          }\r\n        }\r\n      }\r\n    });\r\n    // window.onkeydown = (ev: KeyboardEvent): any => {\r\n    //   if (!this.this.birdOnSlingShot && ev.key === \"r\") {\r\n    //   }\r\n    // };\r\n  }\r\n\r\n  process(): void {}\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}