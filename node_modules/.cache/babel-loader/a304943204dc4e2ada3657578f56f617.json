{"ast":null,"code":"import _regeneratorRuntime from\"D:/projects/test-game/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"D:/projects/test-game/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import{createStage,createViewport,createGameLoop,ShapeRenderer,Texture,TextureRegion,PolygonBatch,Animation,PlayMode,ViewportInputHandler,InputEvent,Vector2}from\"gdxts\";export var initTest2=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var stage,canvas,viewport,gl,characterTexture,regions,walkDownAnimation,walkLeftAnimation,walkRightAnimation,walkUpAnimation,shapeRenderer,batch,camera,inputHandler,characterPosition,rotation,frame,nextPositon,moveSpeed;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:stage=createStage();canvas=stage.getCanvas();viewport=createViewport(canvas,500,1000);gl=viewport.getContext();// eslint-disable-next-line\n// const texture = await Texture.load(gl, \"./charizard.png\");\n_context.next=6;return Texture.load(gl,\"./spritesheet.png\");case 6:characterTexture=_context.sent;regions=TextureRegion.splitTexture(characterTexture,4,4);walkDownAnimation=new Animation(regions.slice(0,4),0.2);walkLeftAnimation=new Animation(regions.slice(4,8),0.2);walkRightAnimation=new Animation(regions.slice(8,12),0.2);walkUpAnimation=new Animation(regions.slice(12,16),0.2);shapeRenderer=new ShapeRenderer(gl);batch=new PolygonBatch(gl);camera=viewport.getCamera();inputHandler=new ViewportInputHandler(viewport);characterPosition=new Vector2(250,500);rotation=0;// const ROTATION_SPEED = Math.PI * 2;\nframe=0;gl.clearColor(0,0,0,1);nextPositon=new Vector2(250,500);inputHandler.addEventListener(InputEvent.TouchStart,function(x,y){nextPositon=inputHandler.getTouchedWorldCoord();rotation=Math.atan2(nextPositon.y-characterPosition.y,nextPositon.x-characterPosition.x)*180/Math.PI;console.log(rotation);});moveSpeed=150;createGameLoop(function(delta){gl.clear(gl.COLOR_BUFFER_BIT);shapeRenderer.setProjection(camera.projectionView.values);shapeRenderer.begin();shapeRenderer.rect(true,0,0,500,1000);shapeRenderer.end();var region=walkDownAnimation.getKeyFrame(frame,PlayMode.NORMAL);if(characterPosition.x!==nextPositon.x||characterPosition.y!==nextPositon.y){frame+=delta;if(rotation>=0&&rotation<90){if(characterPosition.y<nextPositon.y){region=walkUpAnimation.getKeyFrame(frame,PlayMode.LOOP);characterPosition.y=Math.min(characterPosition.y+delta*moveSpeed,nextPositon.y);// increase y\n}else{if(characterPosition.x<nextPositon.x){region=walkRightAnimation.getKeyFrame(frame,PlayMode.LOOP);characterPosition.x=Math.min(characterPosition.x+delta*moveSpeed,nextPositon.x);// increase x\n}}}if(rotation>=-90&&rotation<0){if(characterPosition.x<nextPositon.x){region=walkRightAnimation.getKeyFrame(frame,PlayMode.LOOP);characterPosition.x=Math.min(characterPosition.x+delta*moveSpeed,nextPositon.x);// increase x\n}else{if(characterPosition.y>nextPositon.y){region=walkDownAnimation.getKeyFrame(frame,PlayMode.LOOP);characterPosition.y=Math.max(characterPosition.y-delta*moveSpeed,nextPositon.y);// decrease y\n}}}if(rotation>=90&&rotation<180){if(characterPosition.y<nextPositon.y){region=walkUpAnimation.getKeyFrame(frame,PlayMode.LOOP);characterPosition.y=Math.min(characterPosition.y+delta*moveSpeed,nextPositon.y);// increase y\n}else{if(characterPosition.x>nextPositon.x){region=walkLeftAnimation.getKeyFrame(frame,PlayMode.LOOP);characterPosition.x=Math.max(characterPosition.x-delta*moveSpeed,nextPositon.x);// decrease x\n}}}if(rotation>=-180&&rotation<-90){if(characterPosition.y>nextPositon.y){region=walkDownAnimation.getKeyFrame(frame,PlayMode.LOOP);characterPosition.y=Math.max(characterPosition.y-delta*moveSpeed,nextPositon.y);// decrease y\n}else{if(characterPosition.x>nextPositon.x){region=walkLeftAnimation.getKeyFrame(frame,PlayMode.LOOP);characterPosition.x=Math.max(characterPosition.x-delta*moveSpeed,nextPositon.x);// decrease x\n}}}}else{frame=0;}batch.setProjection(camera.projectionView.values);batch.begin();// console.log(frame);\nregion.draw(batch,characterPosition.x-50,characterPosition.y,100,100);batch.end();});case 24:case\"end\":return _context.stop();}}},_callee);}));return function initTest2(){return _ref.apply(this,arguments);};}();","map":{"version":3,"names":["createStage","createViewport","createGameLoop","ShapeRenderer","Texture","TextureRegion","PolygonBatch","Animation","PlayMode","ViewportInputHandler","InputEvent","Vector2","initTest2","stage","canvas","getCanvas","viewport","gl","getContext","load","characterTexture","regions","splitTexture","walkDownAnimation","slice","walkLeftAnimation","walkRightAnimation","walkUpAnimation","shapeRenderer","batch","camera","getCamera","inputHandler","characterPosition","rotation","frame","clearColor","nextPositon","addEventListener","TouchStart","x","y","getTouchedWorldCoord","Math","atan2","PI","console","log","moveSpeed","delta","clear","COLOR_BUFFER_BIT","setProjection","projectionView","values","begin","rect","end","region","getKeyFrame","NORMAL","LOOP","min","max","draw"],"sources":["D:/projects/test-game/src/test2.ts"],"sourcesContent":["import {\r\n  createStage,\r\n  createViewport,\r\n  createGameLoop,\r\n  ShapeRenderer,\r\n  Texture,\r\n  TextureRegion,\r\n  PolygonBatch,\r\n  Animation,\r\n  PlayMode,\r\n  ViewportInputHandler,\r\n  InputEvent,\r\n  Vector2,\r\n} from \"gdxts\";\r\n\r\nexport const initTest2 = async () => {\r\n  const stage = createStage();\r\n  const canvas = stage.getCanvas();\r\n  const viewport = createViewport(canvas, 500, 1000);\r\n  const gl = viewport.getContext();\r\n\r\n  // eslint-disable-next-line\r\n  // const texture = await Texture.load(gl, \"./charizard.png\");\r\n  const characterTexture = await Texture.load(gl, \"./spritesheet.png\");\r\n  const regions = TextureRegion.splitTexture(characterTexture, 4, 4);\r\n\r\n  const walkDownAnimation = new Animation(regions.slice(0, 4), 0.2);\r\n  const walkLeftAnimation = new Animation(regions.slice(4, 8), 0.2);\r\n  const walkRightAnimation = new Animation(regions.slice(8, 12), 0.2);\r\n  const walkUpAnimation = new Animation(regions.slice(12, 16), 0.2);\r\n\r\n  const shapeRenderer = new ShapeRenderer(gl);\r\n  const batch = new PolygonBatch(gl);\r\n  const camera = viewport.getCamera();\r\n\r\n  const inputHandler = new ViewportInputHandler(viewport);\r\n  const characterPosition = new Vector2(250, 500);\r\n\r\n  let rotation = 0;\r\n  // const ROTATION_SPEED = Math.PI * 2;\r\n  let frame = 0;\r\n  gl.clearColor(0, 0, 0, 1);\r\n\r\n  let nextPositon = new Vector2(250, 500);\r\n  inputHandler.addEventListener(InputEvent.TouchStart, (x, y) => {\r\n    nextPositon = inputHandler.getTouchedWorldCoord();\r\n    rotation =\r\n      (Math.atan2(\r\n        nextPositon.y - characterPosition.y,\r\n        nextPositon.x - characterPosition.x\r\n      ) *\r\n        180) /\r\n      Math.PI;\r\n    console.log(rotation);\r\n  });\r\n\r\n  const moveSpeed = 150;\r\n\r\n  createGameLoop((delta: number) => {\r\n    gl.clear(gl.COLOR_BUFFER_BIT);\r\n    shapeRenderer.setProjection(camera.projectionView.values);\r\n    shapeRenderer.begin();\r\n    shapeRenderer.rect(true, 0, 0, 500, 1000);\r\n    shapeRenderer.end();\r\n    let region = walkDownAnimation.getKeyFrame(frame, PlayMode.NORMAL);\r\n\r\n    if (\r\n      characterPosition.x !== nextPositon.x ||\r\n      characterPosition.y !== nextPositon.y\r\n    ) {\r\n      frame += delta;\r\n      if (rotation >= 0 && rotation < 90) {\r\n        if (characterPosition.y < nextPositon.y) {\r\n          region = walkUpAnimation.getKeyFrame(frame, PlayMode.LOOP);\r\n          characterPosition.y = Math.min(\r\n            characterPosition.y + delta * moveSpeed,\r\n            nextPositon.y\r\n          ); // increase y\r\n        } else {\r\n          if (characterPosition.x < nextPositon.x) {\r\n            region = walkRightAnimation.getKeyFrame(frame, PlayMode.LOOP);\r\n            characterPosition.x = Math.min(\r\n              characterPosition.x + delta * moveSpeed,\r\n              nextPositon.x\r\n            ); // increase x\r\n          }\r\n        }\r\n      }\r\n      if (rotation >= -90 && rotation < 0) {\r\n        if (characterPosition.x < nextPositon.x) {\r\n          region = walkRightAnimation.getKeyFrame(frame, PlayMode.LOOP);\r\n          characterPosition.x = Math.min(\r\n            characterPosition.x + delta * moveSpeed,\r\n            nextPositon.x\r\n          ); // increase x\r\n        } else {\r\n          if (characterPosition.y > nextPositon.y) {\r\n            region = walkDownAnimation.getKeyFrame(frame, PlayMode.LOOP);\r\n            characterPosition.y = Math.max(\r\n              characterPosition.y - delta * moveSpeed,\r\n              nextPositon.y\r\n            ); // decrease y\r\n          }\r\n        }\r\n      }\r\n      if (rotation >= 90 && rotation < 180) {\r\n        if (characterPosition.y < nextPositon.y) {\r\n          region = walkUpAnimation.getKeyFrame(frame, PlayMode.LOOP);\r\n          characterPosition.y = Math.min(\r\n            characterPosition.y + delta * moveSpeed,\r\n            nextPositon.y\r\n          ); // increase y\r\n        } else {\r\n          if (characterPosition.x > nextPositon.x) {\r\n            region = walkLeftAnimation.getKeyFrame(frame, PlayMode.LOOP);\r\n            characterPosition.x = Math.max(\r\n              characterPosition.x - delta * moveSpeed,\r\n              nextPositon.x\r\n            ); // decrease x\r\n          }\r\n        }\r\n      }\r\n      if (rotation >= -180 && rotation < -90) {\r\n        if (characterPosition.y > nextPositon.y) {\r\n          region = walkDownAnimation.getKeyFrame(frame, PlayMode.LOOP);\r\n          characterPosition.y = Math.max(\r\n            characterPosition.y - delta * moveSpeed,\r\n            nextPositon.y\r\n          ); // decrease y\r\n        } else {\r\n          if (characterPosition.x > nextPositon.x) {\r\n            region = walkLeftAnimation.getKeyFrame(frame, PlayMode.LOOP);\r\n            characterPosition.x = Math.max(\r\n              characterPosition.x - delta * moveSpeed,\r\n              nextPositon.x\r\n            ); // decrease x\r\n          }\r\n        }\r\n      }\r\n    } else {\r\n      frame = 0;\r\n    }\r\n\r\n    batch.setProjection(camera.projectionView.values);\r\n    batch.begin();\r\n    // console.log(frame);\r\n    region.draw(batch, characterPosition.x - 50, characterPosition.y, 100, 100);\r\n    batch.end();\r\n  });\r\n};\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}