{"ast":null,"code":"\"use strict\";\n\nvar _createForOfIteratorHelper = require(\"D:/projects/test-game/node_modules/@babel/runtime/helpers/createForOfIteratorHelper.js\").default;\n\nvar _slicedToArray = require(\"D:/projects/test-game/node_modules/@babel/runtime/helpers/slicedToArray.js\").default;\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.createViewport = void 0;\n\nvar Camera_1 = require(\"./Camera\");\n\nvar Utils_1 = require(\"./Utils\");\n\nvar createViewport = function createViewport(canvas, width, height, options) {\n  var defaultOptions = {\n    autoUpdate: true,\n    pixelRatio: undefined,\n    crop: true\n  };\n  options = Object.assign(Object.assign({}, defaultOptions), options);\n  var contextOption;\n\n  if (options.disablePremultipliedAlpha) {\n    contextOption = {\n      premultipliedAlpha: false\n    };\n  }\n\n  contextOption = Object.assign(Object.assign({}, contextOption), options.contextOption);\n  var gl = canvas.getContext('webgl2', contextOption);\n  var additionalCameras = [];\n  var _options = options,\n      autoUpdate = _options.autoUpdate,\n      pixelRatio = _options.pixelRatio,\n      crop = _options.crop;\n  pixelRatio = pixelRatio || window.devicePixelRatio || 1;\n  var viewportInfo = {\n    pixelRatio: pixelRatio,\n    x: 0,\n    y: 0,\n    width: width,\n    height: height,\n    worldWidth: width,\n    worldHeight: height\n  };\n  var resizeHandler;\n\n  var _ref = (0, Utils_1.resizeCanvas)(canvas, pixelRatio),\n      _ref2 = _slicedToArray(_ref, 2),\n      vWidth = _ref2[0],\n      vHeight = _ref2[1];\n\n  var camera = new Camera_1.OrthoCamera(width, height, vWidth, vHeight);\n\n  if (autoUpdate) {\n    resizeHandler = function resizeHandler(e) {\n      viewportObject.update();\n    };\n\n    window.addEventListener('resize', resizeHandler);\n  }\n\n  var viewportObject = {\n    getViewportInfo: function getViewportInfo() {\n      return viewportInfo;\n    },\n    getCamera: function getCamera() {\n      return camera;\n    },\n    addCamera: function addCamera(camera) {\n      additionalCameras.push(camera);\n    },\n    getContext: function getContext() {\n      return gl;\n    },\n    getCanvas: function getCanvas() {\n      return canvas;\n    },\n    update: function update() {\n      var _ref3 = (0, Utils_1.resizeCanvas)(canvas, pixelRatio),\n          _ref4 = _slicedToArray(_ref3, 2),\n          vWidth = _ref4[0],\n          vHeight = _ref4[1];\n\n      var ratio = width / height;\n      var vRatio = vWidth / vHeight;\n\n      if (crop) {\n        var displayWidth, displayHeight;\n\n        if (ratio < vRatio) {\n          displayHeight = vHeight;\n          displayWidth = vHeight * ratio;\n        } else {\n          displayWidth = vWidth;\n          displayHeight = vWidth / ratio;\n        }\n\n        var displayX = (vWidth - displayWidth) / 2;\n        var displayY = (vHeight - displayHeight) / 2;\n        viewportInfo.x = displayX;\n        viewportInfo.y = displayY;\n        viewportInfo.width = displayWidth;\n        viewportInfo.height = displayHeight;\n        gl.viewport(displayX, displayY, displayWidth, displayHeight);\n        camera.setPosition(width / 2, height / 2);\n        camera.resize(width, height, displayWidth, displayHeight);\n\n        var _iterator = _createForOfIteratorHelper(additionalCameras),\n            _step;\n\n        try {\n          for (_iterator.s(); !(_step = _iterator.n()).done;) {\n            var _camera = _step.value;\n\n            _camera.setPosition(width / 2, height / 2);\n\n            _camera.resize(width, height, displayWidth, displayHeight);\n          }\n        } catch (err) {\n          _iterator.e(err);\n        } finally {\n          _iterator.f();\n        }\n      } else {\n        viewportInfo.x = 0;\n        viewportInfo.y = 0;\n        viewportInfo.width = vWidth;\n        viewportInfo.height = vHeight;\n        gl.viewport(0, 0, vWidth, vHeight);\n        var cameraWidth, cameraHeight, cameraX, cameraY;\n\n        if (ratio < vRatio) {\n          cameraHeight = height;\n          cameraWidth = cameraHeight * vRatio;\n          cameraX = -(cameraWidth - width) / 2;\n          cameraY = 0;\n        } else {\n          cameraWidth = width;\n          cameraHeight = cameraWidth / vRatio;\n          cameraX = 0;\n          cameraY = -(cameraHeight - height) / 2;\n        }\n\n        camera.setPosition(cameraX + cameraWidth / 2, cameraY + cameraHeight / 2);\n        camera.resize(cameraWidth, cameraHeight, vWidth, vHeight);\n\n        var _iterator2 = _createForOfIteratorHelper(additionalCameras),\n            _step2;\n\n        try {\n          for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n            var _camera2 = _step2.value;\n\n            _camera2.setPosition(cameraX + cameraWidth / 2, cameraY + cameraHeight / 2);\n\n            _camera2.resize(cameraWidth, cameraHeight, vWidth, vHeight);\n          }\n        } catch (err) {\n          _iterator2.e(err);\n        } finally {\n          _iterator2.f();\n        }\n      }\n    },\n    cleanUp: function cleanUp() {\n      if (resizeHandler) {\n        window.removeEventListener('resize', resizeHandler);\n      }\n    }\n  };\n  autoUpdate && viewportObject.update();\n  return viewportObject;\n};\n\nexports.createViewport = createViewport;","map":{"version":3,"names":["Object","defineProperty","exports","value","createViewport","Camera_1","require","Utils_1","canvas","width","height","options","defaultOptions","autoUpdate","pixelRatio","undefined","crop","assign","contextOption","disablePremultipliedAlpha","premultipliedAlpha","gl","getContext","additionalCameras","window","devicePixelRatio","viewportInfo","x","y","worldWidth","worldHeight","resizeHandler","resizeCanvas","vWidth","vHeight","camera","OrthoCamera","e","viewportObject","update","addEventListener","getViewportInfo","getCamera","addCamera","push","getCanvas","ratio","vRatio","displayWidth","displayHeight","displayX","displayY","viewport","setPosition","resize","cameraWidth","cameraHeight","cameraX","cameraY","cleanUp","removeEventListener"],"sources":["D:/projects/test-game/node_modules/gdxts/dist/lib/Viewport.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.createViewport = void 0;\nconst Camera_1 = require(\"./Camera\");\nconst Utils_1 = require(\"./Utils\");\nconst createViewport = (canvas, width, height, options) => {\n    const defaultOptions = {\n        autoUpdate: true,\n        pixelRatio: undefined,\n        crop: true\n    };\n    options = Object.assign(Object.assign({}, defaultOptions), options);\n    let contextOption;\n    if (options.disablePremultipliedAlpha) {\n        contextOption = {\n            premultipliedAlpha: false\n        };\n    }\n    contextOption = Object.assign(Object.assign({}, contextOption), options.contextOption);\n    const gl = canvas.getContext('webgl2', contextOption);\n    const additionalCameras = [];\n    let { autoUpdate, pixelRatio, crop } = options;\n    pixelRatio = pixelRatio || window.devicePixelRatio || 1;\n    const viewportInfo = {\n        pixelRatio,\n        x: 0,\n        y: 0,\n        width,\n        height,\n        worldWidth: width,\n        worldHeight: height\n    };\n    let resizeHandler;\n    const [vWidth, vHeight] = (0, Utils_1.resizeCanvas)(canvas, pixelRatio);\n    const camera = new Camera_1.OrthoCamera(width, height, vWidth, vHeight);\n    if (autoUpdate) {\n        resizeHandler = e => {\n            viewportObject.update();\n        };\n        window.addEventListener('resize', resizeHandler);\n    }\n    const viewportObject = {\n        getViewportInfo() {\n            return viewportInfo;\n        },\n        getCamera() {\n            return camera;\n        },\n        addCamera(camera) {\n            additionalCameras.push(camera);\n        },\n        getContext() {\n            return gl;\n        },\n        getCanvas() {\n            return canvas;\n        },\n        update() {\n            let [vWidth, vHeight] = (0, Utils_1.resizeCanvas)(canvas, pixelRatio);\n            const ratio = width / height;\n            const vRatio = vWidth / vHeight;\n            if (crop) {\n                let displayWidth, displayHeight;\n                if (ratio < vRatio) {\n                    displayHeight = vHeight;\n                    displayWidth = vHeight * ratio;\n                }\n                else {\n                    displayWidth = vWidth;\n                    displayHeight = vWidth / ratio;\n                }\n                const displayX = (vWidth - displayWidth) / 2;\n                const displayY = (vHeight - displayHeight) / 2;\n                viewportInfo.x = displayX;\n                viewportInfo.y = displayY;\n                viewportInfo.width = displayWidth;\n                viewportInfo.height = displayHeight;\n                gl.viewport(displayX, displayY, displayWidth, displayHeight);\n                camera.setPosition(width / 2, height / 2);\n                camera.resize(width, height, displayWidth, displayHeight);\n                for (let camera of additionalCameras) {\n                    camera.setPosition(width / 2, height / 2);\n                    camera.resize(width, height, displayWidth, displayHeight);\n                }\n            }\n            else {\n                viewportInfo.x = 0;\n                viewportInfo.y = 0;\n                viewportInfo.width = vWidth;\n                viewportInfo.height = vHeight;\n                gl.viewport(0, 0, vWidth, vHeight);\n                let cameraWidth, cameraHeight, cameraX, cameraY;\n                if (ratio < vRatio) {\n                    cameraHeight = height;\n                    cameraWidth = cameraHeight * vRatio;\n                    cameraX = -(cameraWidth - width) / 2;\n                    cameraY = 0;\n                }\n                else {\n                    cameraWidth = width;\n                    cameraHeight = cameraWidth / vRatio;\n                    cameraX = 0;\n                    cameraY = -(cameraHeight - height) / 2;\n                }\n                camera.setPosition(cameraX + cameraWidth / 2, cameraY + cameraHeight / 2);\n                camera.resize(cameraWidth, cameraHeight, vWidth, vHeight);\n                for (let camera of additionalCameras) {\n                    camera.setPosition(cameraX + cameraWidth / 2, cameraY + cameraHeight / 2);\n                    camera.resize(cameraWidth, cameraHeight, vWidth, vHeight);\n                }\n            }\n        },\n        cleanUp() {\n            if (resizeHandler) {\n                window.removeEventListener('resize', resizeHandler);\n            }\n        }\n    };\n    autoUpdate && viewportObject.update();\n    return viewportObject;\n};\nexports.createViewport = createViewport;\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}