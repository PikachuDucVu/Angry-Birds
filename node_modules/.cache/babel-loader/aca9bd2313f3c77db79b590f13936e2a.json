{"ast":null,"code":"\"use strict\";\n\nvar _classCallCheck = require(\"D:/projects/test-game/node_modules/@babel/runtime/helpers/classCallCheck.js\").default;\n\nvar _createClass = require(\"D:/projects/test-game/node_modules/@babel/runtime/helpers/createClass.js\").default;\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.InputHandler = exports.InputEvent = void 0;\n\nvar events_1 = require(\"events\");\n\nvar Vector2_1 = require(\"./Vector2\");\n\nvar InputEvent;\n\n(function (InputEvent) {\n  InputEvent[\"TouchStart\"] = \"touchStart\";\n  InputEvent[\"TouchEnd\"] = \"touchEnd\";\n  InputEvent[\"TouchMove\"] = \"touchMove\";\n})(InputEvent = exports.InputEvent || (exports.InputEvent = {}));\n\nvar InputHandler = /*#__PURE__*/function () {\n  function InputHandler(canvas) {\n    var _this = this;\n\n    _classCallCheck(this, InputHandler);\n\n    this.screenCoord = new Vector2_1.Vector2();\n    this.worldCoord = new Vector2_1.Vector2();\n    this.canvas = canvas;\n    this.lastX = 0;\n    this.lastY = 0;\n    this.touched = false;\n    var emitter = this.emitter = new events_1.EventEmitter();\n\n    this.mouseDownHandler = function (evt) {\n      _this.touched = true;\n\n      _this.handleMove(evt);\n\n      emitter.emit('touchStart', _this.getX(), _this.getY());\n    };\n\n    this.mouseUpHandler = function (evt) {\n      _this.touched = false;\n      emitter.emit('touchEnd', _this.getX(), _this.getY());\n    };\n\n    this.mouseMoveHandler = function (evt) {\n      _this.handleMove(evt);\n\n      emitter.emit('touchMove', _this.getX(), _this.getY());\n    };\n\n    this.touchStartHandler = function (evt) {\n      evt.preventDefault(); // TODO: handle multi touch\n\n      var touch = evt.touches[0];\n\n      _this.canvas.dispatchEvent(new MouseEvent('mousedown', {\n        clientX: touch.clientX,\n        clientY: touch.clientY\n      }));\n    };\n\n    this.touchEndHandler = function (evt) {\n      evt.preventDefault();\n\n      _this.canvas.dispatchEvent(new MouseEvent('mouseup'));\n    };\n\n    this.touchMoveHandler = function (evt) {\n      evt.preventDefault();\n      var touch = evt.touches[0];\n\n      _this.canvas.dispatchEvent(new MouseEvent('mousemove', {\n        clientX: touch.clientX,\n        clientY: touch.clientY\n      }));\n    };\n\n    this.canvas.addEventListener('mousedown', this.mouseDownHandler, false);\n    this.canvas.addEventListener('mouseup', this.mouseUpHandler, false);\n    this.canvas.addEventListener('mousemove', this.mouseMoveHandler, false);\n    this.canvas.addEventListener('touchstart', this.touchStartHandler, false);\n    this.canvas.addEventListener('touchend', this.touchEndHandler, false);\n    this.canvas.addEventListener('touchmove', this.touchMoveHandler, false);\n  }\n\n  _createClass(InputHandler, [{\n    key: \"cleanup\",\n    value: function cleanup() {\n      this.canvas.removeEventListener('mousedown', this.mouseDownHandler);\n      this.canvas.removeEventListener('mouseup', this.mouseUpHandler);\n      this.canvas.removeEventListener('mousemove', this.mouseMoveHandler);\n      this.canvas.removeEventListener('touchstart', this.touchStartHandler);\n      this.canvas.removeEventListener('touchend', this.touchEndHandler);\n      this.canvas.removeEventListener('touchmove', this.touchMoveHandler);\n    }\n  }, {\n    key: \"addEventListener\",\n    value: function addEventListener(event, listener) {\n      this.emitter.addListener(event, listener);\n    }\n  }, {\n    key: \"handleMove\",\n    value: function handleMove(evt) {\n      var rect = this.canvas.getBoundingClientRect();\n      var x = evt.clientX - rect.left;\n      var y = evt.clientY - rect.top;\n      this.lastX = x;\n      this.lastY = y;\n    }\n  }, {\n    key: \"getX\",\n    value: function getX() {\n      return this.lastX;\n    }\n  }, {\n    key: \"getY\",\n    value: function getY() {\n      return this.lastY;\n    }\n  }, {\n    key: \"isTouched\",\n    value: function isTouched() {\n      return this.touched;\n    }\n  }, {\n    key: \"getTouchedWorldCoord\",\n    value: function getTouchedWorldCoord(camera) {\n      this.screenCoord.set(this.getX(), this.getY());\n      camera.unprojectVector2(this.worldCoord, this.screenCoord);\n      return this.worldCoord;\n    }\n  }]);\n\n  return InputHandler;\n}();\n\nexports.InputHandler = InputHandler;","map":{"version":3,"names":["Object","defineProperty","exports","value","InputHandler","InputEvent","events_1","require","Vector2_1","canvas","screenCoord","Vector2","worldCoord","lastX","lastY","touched","emitter","EventEmitter","mouseDownHandler","evt","handleMove","emit","getX","getY","mouseUpHandler","mouseMoveHandler","touchStartHandler","preventDefault","touch","touches","dispatchEvent","MouseEvent","clientX","clientY","touchEndHandler","touchMoveHandler","addEventListener","removeEventListener","event","listener","addListener","rect","getBoundingClientRect","x","left","y","top","camera","set","unprojectVector2"],"sources":["D:/projects/test-game/node_modules/gdxts/dist/lib/InputHandler.js"],"sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.InputHandler = exports.InputEvent = void 0;\r\nconst events_1 = require(\"events\");\r\nconst Vector2_1 = require(\"./Vector2\");\r\nvar InputEvent;\r\n(function (InputEvent) {\r\n    InputEvent[\"TouchStart\"] = \"touchStart\";\r\n    InputEvent[\"TouchEnd\"] = \"touchEnd\";\r\n    InputEvent[\"TouchMove\"] = \"touchMove\";\r\n})(InputEvent = exports.InputEvent || (exports.InputEvent = {}));\r\nclass InputHandler {\r\n    constructor(canvas) {\r\n        this.screenCoord = new Vector2_1.Vector2();\r\n        this.worldCoord = new Vector2_1.Vector2();\r\n        this.canvas = canvas;\r\n        this.lastX = 0;\r\n        this.lastY = 0;\r\n        this.touched = false;\r\n        const emitter = (this.emitter = new events_1.EventEmitter());\r\n        this.mouseDownHandler = evt => {\r\n            this.touched = true;\r\n            this.handleMove(evt);\r\n            emitter.emit('touchStart', this.getX(), this.getY());\r\n        };\r\n        this.mouseUpHandler = evt => {\r\n            this.touched = false;\r\n            emitter.emit('touchEnd', this.getX(), this.getY());\r\n        };\r\n        this.mouseMoveHandler = evt => {\r\n            this.handleMove(evt);\r\n            emitter.emit('touchMove', this.getX(), this.getY());\r\n        };\r\n        this.touchStartHandler = evt => {\r\n            evt.preventDefault();\r\n            // TODO: handle multi touch\r\n            let touch = evt.touches[0];\r\n            this.canvas.dispatchEvent(new MouseEvent('mousedown', {\r\n                clientX: touch.clientX,\r\n                clientY: touch.clientY\r\n            }));\r\n        };\r\n        this.touchEndHandler = evt => {\r\n            evt.preventDefault();\r\n            this.canvas.dispatchEvent(new MouseEvent('mouseup'));\r\n        };\r\n        this.touchMoveHandler = evt => {\r\n            evt.preventDefault();\r\n            let touch = evt.touches[0];\r\n            this.canvas.dispatchEvent(new MouseEvent('mousemove', {\r\n                clientX: touch.clientX,\r\n                clientY: touch.clientY\r\n            }));\r\n        };\r\n        this.canvas.addEventListener('mousedown', this.mouseDownHandler, false);\r\n        this.canvas.addEventListener('mouseup', this.mouseUpHandler, false);\r\n        this.canvas.addEventListener('mousemove', this.mouseMoveHandler, false);\r\n        this.canvas.addEventListener('touchstart', this.touchStartHandler, false);\r\n        this.canvas.addEventListener('touchend', this.touchEndHandler, false);\r\n        this.canvas.addEventListener('touchmove', this.touchMoveHandler, false);\r\n    }\r\n    cleanup() {\r\n        this.canvas.removeEventListener('mousedown', this.mouseDownHandler);\r\n        this.canvas.removeEventListener('mouseup', this.mouseUpHandler);\r\n        this.canvas.removeEventListener('mousemove', this.mouseMoveHandler);\r\n        this.canvas.removeEventListener('touchstart', this.touchStartHandler);\r\n        this.canvas.removeEventListener('touchend', this.touchEndHandler);\r\n        this.canvas.removeEventListener('touchmove', this.touchMoveHandler);\r\n    }\r\n    addEventListener(event, listener) {\r\n        this.emitter.addListener(event, listener);\r\n    }\r\n    handleMove(evt) {\r\n        const rect = this.canvas.getBoundingClientRect();\r\n        const x = evt.clientX - rect.left;\r\n        const y = evt.clientY - rect.top;\r\n        this.lastX = x;\r\n        this.lastY = y;\r\n    }\r\n    getX() {\r\n        return this.lastX;\r\n    }\r\n    getY() {\r\n        return this.lastY;\r\n    }\r\n    isTouched() {\r\n        return this.touched;\r\n    }\r\n    getTouchedWorldCoord(camera) {\r\n        this.screenCoord.set(this.getX(), this.getY());\r\n        camera.unprojectVector2(this.worldCoord, this.screenCoord);\r\n        return this.worldCoord;\r\n    }\r\n}\r\nexports.InputHandler = InputHandler;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}