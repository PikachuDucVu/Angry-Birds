{"ast":null,"code":"import _regeneratorRuntime from\"D:/projects/test-game/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"D:/projects/test-game/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import{createStage,createViewport,createGameLoop,ShapeRenderer,Texture,TextureRegion,PolygonBatch,Animation,PlayMode,ViewportInputHandler,InputEvent,Vector2}from\"gdxts\";import{initTest2}from\"./test2\";var init=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var stage,canvas,viewport,gl,characterTexture,regions,walkDownAnimation,walkLeftAnimation,walkRightAnimation,walkUpAnimation,shapeRenderer,batch,camera,inputHandler,characterPosition,rotation,frame,nextPositon,moveSpeed,changePosition;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:changePosition=function _changePosition(delta){if(characterPosition.x<nextPositon.x){characterPosition.x=Math.min(characterPosition.x+delta*moveSpeed,nextPositon.x);}if(characterPosition.y<nextPositon.y){characterPosition.y=Math.min(characterPosition.y+delta*moveSpeed,nextPositon.y);}if(characterPosition.x>nextPositon.x){characterPosition.x=Math.max(characterPosition.x-delta*moveSpeed,nextPositon.x);}if(characterPosition.y>nextPositon.y){characterPosition.y=Math.max(characterPosition.y-delta*moveSpeed,nextPositon.y);}};stage=createStage();canvas=stage.getCanvas();viewport=createViewport(canvas,500,1000);gl=viewport.getContext();// eslint-disable-next-line\n_context.next=7;return Texture.load(gl,\"./spritesheet.png\");case 7:characterTexture=_context.sent;regions=TextureRegion.splitTexture(characterTexture,4,4);walkDownAnimation=new Animation(regions.slice(0,4),0.2);walkLeftAnimation=new Animation(regions.slice(4,8),0.2);walkRightAnimation=new Animation(regions.slice(8,12),0.2);walkUpAnimation=new Animation(regions.slice(12,16),0.2);shapeRenderer=new ShapeRenderer(gl);batch=new PolygonBatch(gl);camera=viewport.getCamera();inputHandler=new ViewportInputHandler(viewport);characterPosition=new Vector2(250,500);rotation=0;// const ROTATION_SPEED = Math.PI * 2;\nframe=0;gl.clearColor(0,0,0,1);nextPositon=new Vector2(250,500);inputHandler.addEventListener(InputEvent.TouchStart,function(x,y){nextPositon=inputHandler.getTouchedWorldCoord();rotation=Math.atan2(nextPositon.y-characterPosition.y,nextPositon.x-characterPosition.x)*180/Math.PI;});moveSpeed=150;createGameLoop(function(delta){gl.clear(gl.COLOR_BUFFER_BIT);shapeRenderer.setProjection(camera.projectionView.values);shapeRenderer.begin();shapeRenderer.rect(true,0,0,500,1000);shapeRenderer.end();var region=walkDownAnimation.getKeyFrame(frame,PlayMode.NORMAL);if(characterPosition.x!==nextPositon.x||characterPosition.y!==nextPositon.y){frame+=delta;if(rotation>75&&rotation<105){region=walkUpAnimation.getKeyFrame(frame,PlayMode.LOOP);}else if(rotation>-105&&rotation<-75){region=walkDownAnimation.getKeyFrame(frame,PlayMode.LOOP);}else if(rotation>=0&&rotation<90){region=walkRightAnimation.getKeyFrame(frame,PlayMode.LOOP);}else if(rotation>=90&&rotation<180){region=walkLeftAnimation.getKeyFrame(frame,PlayMode.LOOP);}else if(rotation>=-180&&rotation<-90){region=walkLeftAnimation.getKeyFrame(frame,PlayMode.LOOP);}else{region=walkRightAnimation.getKeyFrame(frame,PlayMode.LOOP);}}else{frame=0;}batch.setProjection(camera.projectionView.values);batch.begin();changePosition(delta);region.draw(batch,characterPosition.x-50,characterPosition.y,100,100);batch.end();});case 25:case\"end\":return _context.stop();}}},_callee);}));return function init(){return _ref.apply(this,arguments);};}();// init();\ninitTest2();export{};","map":{"version":3,"names":["createStage","createViewport","createGameLoop","ShapeRenderer","Texture","TextureRegion","PolygonBatch","Animation","PlayMode","ViewportInputHandler","InputEvent","Vector2","initTest2","init","changePosition","delta","characterPosition","x","nextPositon","Math","min","moveSpeed","y","max","stage","canvas","getCanvas","viewport","gl","getContext","load","characterTexture","regions","splitTexture","walkDownAnimation","slice","walkLeftAnimation","walkRightAnimation","walkUpAnimation","shapeRenderer","batch","camera","getCamera","inputHandler","rotation","frame","clearColor","addEventListener","TouchStart","getTouchedWorldCoord","atan2","PI","clear","COLOR_BUFFER_BIT","setProjection","projectionView","values","begin","rect","end","region","getKeyFrame","NORMAL","LOOP","draw"],"sources":["D:/projects/test-game/src/index.ts"],"sourcesContent":["import {\n  createStage,\n  createViewport,\n  createGameLoop,\n  ShapeRenderer,\n  Texture,\n  TextureRegion,\n  PolygonBatch,\n  Animation,\n  PlayMode,\n  ViewportInputHandler,\n  InputEvent,\n  Vector2,\n} from \"gdxts\";\nimport { initTest2 } from \"./test2\";\nconst init = async () => {\n  const stage = createStage();\n  const canvas = stage.getCanvas();\n  const viewport = createViewport(canvas, 500, 1000);\n  const gl = viewport.getContext();\n\n  // eslint-disable-next-line\n  const characterTexture = await Texture.load(gl, \"./spritesheet.png\");\n  const regions = TextureRegion.splitTexture(characterTexture, 4, 4);\n\n  const walkDownAnimation = new Animation(regions.slice(0, 4), 0.2);\n  const walkLeftAnimation = new Animation(regions.slice(4, 8), 0.2);\n  const walkRightAnimation = new Animation(regions.slice(8, 12), 0.2);\n  const walkUpAnimation = new Animation(regions.slice(12, 16), 0.2);\n\n  const shapeRenderer = new ShapeRenderer(gl);\n  const batch = new PolygonBatch(gl);\n  const camera = viewport.getCamera();\n\n  const inputHandler = new ViewportInputHandler(viewport);\n  const characterPosition = new Vector2(250, 500);\n\n  let rotation = 0;\n  // const ROTATION_SPEED = Math.PI * 2;\n\n  let frame = 0;\n\n  gl.clearColor(0, 0, 0, 1);\n\n  let nextPositon = new Vector2(250, 500);\n\n  inputHandler.addEventListener(InputEvent.TouchStart, (x, y) => {\n    nextPositon = inputHandler.getTouchedWorldCoord();\n    rotation =\n      (Math.atan2(\n        nextPositon.y - characterPosition.y,\n        nextPositon.x - characterPosition.x\n      ) *\n        180) /\n      Math.PI;\n  });\n\n  const moveSpeed = 150;\n  function changePosition(delta: number) {\n    if (characterPosition.x < nextPositon.x) {\n      characterPosition.x = Math.min(\n        characterPosition.x + delta * moveSpeed,\n        nextPositon.x\n      );\n    }\n    if (characterPosition.y < nextPositon.y) {\n      characterPosition.y = Math.min(\n        characterPosition.y + delta * moveSpeed,\n        nextPositon.y\n      );\n    }\n    if (characterPosition.x > nextPositon.x) {\n      characterPosition.x = Math.max(\n        characterPosition.x - delta * moveSpeed,\n        nextPositon.x\n      );\n    }\n    if (characterPosition.y > nextPositon.y) {\n      characterPosition.y = Math.max(\n        characterPosition.y - delta * moveSpeed,\n        nextPositon.y\n      );\n    }\n  }\n\n  createGameLoop((delta: number) => {\n    gl.clear(gl.COLOR_BUFFER_BIT);\n    shapeRenderer.setProjection(camera.projectionView.values);\n    shapeRenderer.begin();\n    shapeRenderer.rect(true, 0, 0, 500, 1000);\n    shapeRenderer.end();\n    let region = walkDownAnimation.getKeyFrame(frame, PlayMode.NORMAL);\n\n    if (\n      characterPosition.x !== nextPositon.x ||\n      characterPosition.y !== nextPositon.y\n    ) {\n      frame += delta;\n      if (rotation > 75 && rotation < 105) {\n        region = walkUpAnimation.getKeyFrame(frame, PlayMode.LOOP);\n      } else if (rotation > -105 && rotation < -75) {\n        region = walkDownAnimation.getKeyFrame(frame, PlayMode.LOOP);\n      } else if (rotation >= 0 && rotation < 90) {\n        region = walkRightAnimation.getKeyFrame(frame, PlayMode.LOOP);\n      } else if (rotation >= 90 && rotation < 180) {\n        region = walkLeftAnimation.getKeyFrame(frame, PlayMode.LOOP);\n      } else if (rotation >= -180 && rotation < -90) {\n        region = walkLeftAnimation.getKeyFrame(frame, PlayMode.LOOP);\n      } else {\n        region = walkRightAnimation.getKeyFrame(frame, PlayMode.LOOP);\n      }\n    } else {\n      frame = 0;\n    }\n\n    batch.setProjection(camera.projectionView.values);\n    batch.begin();\n    changePosition(delta);\n\n    region.draw(batch, characterPosition.x - 50, characterPosition.y, 100, 100);\n    batch.end();\n  });\n};\n// init();\ninitTest2();\n\nexport {};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}